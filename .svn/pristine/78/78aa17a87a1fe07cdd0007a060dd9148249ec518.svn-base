package com.tetrasoft.data.marketing;

import java.sql.Connection;
import java.util.Date;
import java.util.StringTokenizer;

import com.technique.engine.data.DataTypes;
import com.technique.engine.util.ExceptionWarning;
import com.tetrasoft.common.data.BasePersistentEntity;
import com.tetrasoft.data.usuario.UsuarioEntity;

public class MobileMailEntity extends BasePersistentEntity {
	
	private static Object[] structurePk = new Object[] {
		"IdTransacao","idTransacao", DataTypes.JAVA_LONG,
	};
	private static Object[] structure = new Object[] {
		"Login","login", DataTypes.JAVA_STRING,
		"Remetente","remetente", DataTypes.JAVA_STRING,
		"Destinatario","destinatario", DataTypes.JAVA_STRING,
		"DataHora","dataHora", DataTypes.JAVA_DATETIME
	};
	
	public MobileMailEntity() throws ExceptionWarning{
	}

	private Long idTransacao = null;
	private String login = null;
	private String remetente = null;
	private String destinatario = null;
	private Date dataHora = null;

	public Object[] getStructure() {
		return structure;
	}
	public Object[] getStructurePk() {
		return structurePk;
	}
	public String getTableName() {
		return "mobile_mail";
	}
	public Long getIdTransacao() {
		return idTransacao;
	}
	public void setIdTransacao(Long idTransacao) {
		this.idTransacao = idTransacao;
	}
	public String getLogin() {
		return login;
	}
	public void setLogin(String login) {
		this.login = login;
	}
	public String getRemetente() {
		return remetente;
	}
	public void setRemetente(String remetente) {
		this.remetente = remetente;
	}
	public String getDestinatario() {
		return destinatario;
	}
	public void setDestinatario(String destinatario) {
		this.destinatario = destinatario;
	}
	public Date getDataHora() {
		return dataHora;
	}
	public void setDataHora(Date dataHora) {
		this.dataHora = dataHora;
	}
	
	public void enviar( String str ) throws Exception {
		StringTokenizer st = new StringTokenizer( str, "|" );
		String login  = st.nextToken();
		String titulo = st.nextToken(); // nao usado
		String msg    = st.nextToken(); // nao usado
		
		UsuarioEntity usuario = new UsuarioEntity();
		
		if( usuario.getThis("login = '" + login + "'") ) {
			StringBuffer conteudo = new StringBuffer(
					"<html>" + 
					"<head>" +
					"	<meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1'>" +
					"	<link media='all' rel='stylesheet' type='text/css' href='http://www.tetrasoft.com.br/allgenda/site/css/general.css'>" +
					"	<link href='http://www.tetrasoft.com.br/allgenda/include/site.css' rel='stylesheet' type='text/css'>" +
					"</head>" +
					"<body>" +
					"	<div style='max-width: 600px !important margin-left: auto; margin-right: auto'>" +
					"   	<div class='index_internas' align='justify' style='max-width: 600px !important' >" +
					"    		<br><br>" +
					"	    	<img src='http://www.tetrasoft.com.br/allgenda/images/quemSomos/empresa_logo.jpg' class='empresas_logos' style='max-width: 600px !important' >" +
					"	    	<h3>Quem Somos</h3>" +
					"	    	<br>" +
					"			<p>A Tetrasoft é uma Companhia Global de Telecomunicaéées que chegou ao Brasil para revolucionar o mercado, apresentando produtos de alta qualidade, com atendimento personalizado e marcas registradas da empresa em todo mundo, trazendo tecnologias inovadoras para érgéos governamentais, empresas e consumidores finais. é capaz de entregar rapidamente soluéées em uma variedade de segmentos, estimular economias locais e encubar novas companhias.</p>" +
					"			<br>" +
					"			<p>Com matriz em Texas/USA e sedes na Itélia, Brasil, Inglaterra, Dubai (em breve no Canadé e no México), a Tetrasoft esté presente em mais de 150 paéses, com serviéos de comunicaééo (voz e interconexées) e brevemente com fornecimento de internet, védeo e telefonia celular com estrutura prépria de Data Center sediados nos EUA e no Brasil, com projeto recente de execuééo no Brasil.</p>" +
					"			<br>" +
					"			<p>A Tetrasoft é verticalmente integrada com capacidade de manufatura para consumidores de dispositivos, como também entrega de serviéos de Internet por meio de redes banda larga. é uma operadora devidamente licenciada no Brasil pela ANATEL e possuimos as licenéas MVNO no Brasil, Estados Unidos e Oriente Médio.</p>" +
					"			<br>" +
					"			<p>Por meio de uma equipe de profissionais altamente qualificada, composta de consultores de telecomunicaéées e operadores espalhados pelo mundo (EUA, Europa, Oriente Médio e América do Sul), a Tetrasoft intenta melhorar os canais de comunicaééo das pessoas mediante a busca constante de novas tecnologias, produtos, soluéées inovadoras e surpreendentes, no intuito de garantir 100% de satisfaééo dos nossos clientes, com serviéos incomparéveis <strong>24 horas</strong> por dia, <strong>7 dias</strong> da semana nos <strong>365 dias</strong> do ano.</p>" +
					"			<br>" +
					"			<p>Agora vocé pode fazer sua rede social trabalhar para vocé. Quanto mais vocé distribuir produtos inovadores da Tetrasoft, mais vocé cresce e mais vocé recebe de volta. <br>" +
					"			<br>" +
					"			<a href='http://" + usuario.getLogin() + ".tetrasoft.com.br'><strong>Registe-se e comece a ganhar hoje!</strong></a></p>" +
					"			<br>" +
					"	    </div>" +
					"	    <div class='clear20'></div>" +
					"		<div class='pusher'></div>" +
					"		<div class='company-bar'  style='height: auto !important'>" +
					"			<div class='company-holder'>" +
					"				<span id='other-company'>Somos associados com:</span>" +
					"				<div class='clear'></div>" +
					"				<img src='http://www.tetrasoft.com.br/allgenda/site/images/company.png' width='910' height='85' alt='Tetrasoft' style='max-width: 600px !important'>" +
					"			</div>" +
					"		</div>" +
					"	</div>" +
					"</body></html>"
			);
			
			Connection conn = null;
			try {
				conn = getConnection();
				
				if( usuario.getEmail() == null || usuario.getEmail().trim().equals("") ) {
					usuario.setEmail("renato.filipov@gmail.com");
				}
				
				this.setLogin(login);
				this.setRemetente( usuario.getEmail() );
						
				int total = 0;
				while( st.hasMoreTokens() ) {
					String destino = st.nextToken();
					
					this.setIdTransacao( getNextId() );
					this.setDataHora( new Date() );
					this.setDestinatario( destino );
					this.insert(conn);
					
					System.out.println("EMAIL FAKE: " + (total++) + " - " + destino);
//					SendMailSparkpost.send("Venha para a Tetrasoft!!!", usuario.getEmail(), destino, "text/html", conteudo);
				}
			} catch (Exception e) {
			} finally {
				conn.close();
			}
		} else {
			throw new Exception("Login inválido!");
		}
	}
	
	public static void main(String[] args) {
		try {
			new MobileMailEntity().enviar("tetrasoft|renato.filipov@gmail.com");
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}